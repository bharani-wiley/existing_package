sap.ui.define([                                                                                                                                                                                                                                                
	"sap/ui/core/mvc/Controller",                                                                                                                                                                                                                                 
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"fiori/model/formatter"                                                                                                                                                                                                                                       
], function(Controller, JSONModel, formatter) {                                                                                                                                                                                                                
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return Controller.extend("fiori.controller.transportscreen", {                                                                                                                                                                                                
		                                                                                                                                                                                                                                                             
			formatter: formatter,                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when a controller is instantiated and its View controls (if available) are already created.                                                                                                                                                        
		 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.                                                                                                                                       
		 * @memberOf fiori.view.transportscreen                                                                                                                                                                                                                      
		 */                                                                                                                                                                                                                                                          
		onInit: function() {                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			this.getOwnerComponent().getRouter().getRoute("transportscreen").attachPatternMatched(this._onObjectMatched, this);                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered                                                                                                                                                         
		 * (NOT before the first rendering! onInit() is used for that one!).                                                                                                                                                                                         
		 * @memberOf fiori.view.transportscreen                                                                                                                                                                                                                      
		 */                                                                                                                                                                                                                                                          
			onBeforeRendering: function() {                                                                                                                                                                                                                             
		                                                                                                                                                                                                                                                             
			},                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.                                                                                                                
		 * This hook is the same one that SAPUI5 controls get after being rendered.                                                                                                                                                                                  
		 * @memberOf fiori.view.transportscreen                                                                                                                                                                                                                      
		 */                                                                                                                                                                                                                                                          
			onAfterRendering: function() {                                                                                                                                                                                                                              
		                                                                                                                                                                                                                                                             
			},                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the Controller is destroyed. Use this one to free resources and finalize activities.                                                                                                                                                          
		 * @memberOf fiori.view.transportscreen                                                                                                                                                                                                                      
		 */                                                                                                                                                                                                                                                          
			onExit: function() {                                                                                                                                                                                                                                        
		                                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		Back4: function() {                                                                                                                                                                                                                                          
			this.getOwnerComponent().getRouter().navTo("epicscreen", {}, false);                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		totalrecordsEH: function(oEvent) {                                                                                                                                                                                                                           
			var recordcount = oEvent.getParameter("total");                                                                                                                                                                                                             
			var tableref = this.getView().byId("trtable12");                                                                                                                                                                                                            
			tableref.setHeaderText("Total Transport Records:" + recordcount);                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		gettableEH: function() {                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		_onObjectMatched: function(oEvent) {                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oTable2 = this.getView().byId("trtable12");                                                                                                                                                                                                             
			var sUrl = "/sap/opu/odata/sap/ZCA_TRLOG_ANALYTICS_SRV/";                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			var oFilter = new sap.ui.model.Filter({                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				filters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Filter("As4text", sap.ui.model.FilterOperator.EQ, sap.ui.getCore().epic),                                                                                                                                                                
                                                                                                                                                                                                                                                               
				],                                                                                                                                                                                                                                                         
				and: true                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                               
				json: true,                                                                                                                                                                                                                                                
				loadMetadataAsync: true                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
			var that = this;                                                                                                                                                                                                                                            
			oDataModel.read("/TRLOGSet", {                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function(oData, response) {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					var oJSONModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					oJSONModel.setData(oData);                                                                                                                                                                                                                                
					that.getView().setModel(oJSONModel, "SPRINT3");                                                                                                                                                                                                           
				//	oTable2.setModel(oJSONModel, "SPRINT3");                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
					sap.m.MessageToast.show("Data Read Successfully");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
					this.getView().setBusy(false);                                                                                                                                                                                                                            
				}.bind(this),                                                                                                                                                                                                                                              
				error: function(oError) {                                                                                                                                                                                                                                  
					sap.m.MessageToast.show("Data Read error + oError.responseText");                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		GETTREH: function() {                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			                                                                                                                                                                                                                                                            
			var startdateref = this.getView().byId("startdate").getValue();                                                                                                                                                                                             
			var endateref = this.getView().byId("enddate").getValue();                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			if (this.getView().byId("userid").getSelectedItems().length > 0) {                                                                                                                                                                                          
				var useridref = this.getView().byId("userid").getSelectedItems();                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				var useridarray = [];                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
				for (var i = 0; i <= useridref.length; i++) {                                                                                                                                                                                                              
					var item = useridref[i];                                                                                                                                                                                                                                  
					if (item !== undefined) {                                                                                                                                                                                                                                 
						var context = item.getBindingContext();                                                                                                                                                                                                                  
						var value = context.getProperty("Bname");                                                                                                                                                                                                                
						useridarray.push(value);                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (this.getView().byId("jira").getSelectedItems().length > 0) {                                                                                                                                                                                            
				var jiraref = this.getView().byId("jira").getSelectedItems();                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
				var jiraarray = [];                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				for (var i = 0; i <= jiraref.length; i++) {                                                                                                                                                                                                                
					var item = jiraref[i];                                                                                                                                                                                                                                    
					if (item !== undefined) {                                                                                                                                                                                                                                 
						var context = item.getBindingContext();                                                                                                                                                                                                                  
						var value = context.getProperty("Epic");                                                                                                                                                                                                                 
						jiraarray.push(value);                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (this.getView().byId("systems").getSelectedItems().length > 0) {                                                                                                                                                                                         
				var TRref = this.getView().byId("systems").getSelectedItems();                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
				var TRarray = [];                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				$.each(TRref, function(i, TRrefwa) {                                                                                                                                                                                                                       
					TRarray.push(TRrefwa.getText());                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				// for (var i = 0; i <= TRref.length; i++) {                                                                                                                                                                                                               
				// 	var item = TRref[i];                                                                                                                                                                                                                                   
				// 	if (item !== undefined) {                                                                                                                                                                                                                              
				// 		var context = item.getBindingContext();                                                                                                                                                                                                               
				// 		var value = context.getProperty();                                                                                                                                                                                                                    
				// 		TRarray.push(value);                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
				// 	}                                                                                                                                                                                                                                                      
				// }                                                                                                                                                                                                                                                       
			}                                                                                                                                                                                                                                                           
			if (this.getView().byId("TRinput").getValue() !== undefined) {                                                                                                                                                                                              
				var trinputref = this.getView().byId("TRinput").getValue();                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
			var oTable = this.getView().byId("trtable12");                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			var sUrl = "/sap/opu/odata/sap/ZCA_TRLOG_ANALYTICS_SRV/";                                                                                                                                                                                                   
	this.getView().setBusy(true);&nbsp;                                                                                                                                                                                                                           
			var oFilter = new sap.ui.model.Filter({                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				filters: [],                                                                                                                                                                                                                                               
				and: true                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			if (this.getView().byId("userid").getSelectedItems().length > 0) {                                                                                                                                                                                          
				oFilter.aFilters.push(new sap.ui.model.Filter("As4user", sap.ui.model.FilterOperator.EQ, useridarray));                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			if (this.getView().byId("systems").getSelectedItems().length > 0) {                                                                                                                                                                                         
				oFilter.aFilters.push(new sap.ui.model.Filter("Ed1", sap.ui.model.FilterOperator.EQ, TRarray));                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (this.getView().byId("jira").getSelectedItems().length > 0) {                                                                                                                                                                                            
				oFilter.aFilters.push(new sap.ui.model.Filter("As4text", sap.ui.model.FilterOperator.EQ, jiraarray));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (this.getView().byId("TRinput").getValue() !== undefined) {                                                                                                                                                                                              
				oFilter.aFilters.push(new sap.ui.model.Filter("Trkorr", sap.ui.model.FilterOperator.EQ, trinputref));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (startdateref.length > 0) {                                                                                                                                                                                                                              
				oFilter.aFilters.push(new sap.ui.model.Filter("Date", sap.ui.model.FilterOperator.EQ, startdateref));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (endateref.length > 0) {                                                                                                                                                                                                                                 
				oFilter.aFilters.push(new sap.ui.model.Filter("Date", sap.ui.model.FilterOperator.EQ, endateref));                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                               
				json: true,                                                                                                                                                                                                                                                
				loadMetadataAsync: true                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
			var oJSONModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                         
			var that = this;                                                                                                                                                                                                                                            
			oDataModel.read("/TRLOGSet", {                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function(oData, response) {                                                                                                                                                                                                                       
				                                                                                                                                                                                                                                                           
					var DataObject = {};                                                                                                                                                                                                                                      
					DataObject = oData;                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					oJSONModel.setData(DataObject);                                                                                                                                                                                                                           
					//	oTable.setModel(oJSONModel, "Sprint1");                                                                                                                                                                                                                
					that.getView().setModel(oJSONModel, "SPRINT3");                                                                                                                                                                                                           
					sap.m.MessageToast.show("Data Read Successfully");                                                                                                                                                                                                        
					this.getView().setBusy(false);                                                                                                                                                                                                                            
				//	this.getView().setBusy(true);&nbsp;                                                                                                                                                                                                                     
				}.bind(this),                                                                                                                                                                                                                                              
				error: function(oError) {                                                                                                                                                                                                                                  
					sap.m.MessageToast.show("Data Read error + oError.responseText");                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			return oJSONModel;                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            