sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/model/odata/v2/ODataModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/Button","sap/m/Dialog","sap/ui/core/util/Export","sap/ui/core/util/ExportTy+
peCSV","sap/ui/table/TablePersoController","../model/personalization","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/export/library","sap/ui/export/Spreadsheet"],function(e,t,i,a,r,o,s,n,l,p,d,u,g,m,h,c){"use strict";var f=h.EdmType;return e.extend("z+
qtc.ZQTC_CLAIMS.controller.Worklist",{formatter:a,onInit:function(){var e=this;this.getOwnerComponent().getModel().read("/ClaimAuthSet",{success:function(t){if(t.results[0].ClaimAll==="X"){e.getView().byId("claimsProcess").setVisible(true);e.getView().by+
Id("claimsProcess").setIcon("sap-icon://begin");e.getView().byId("claimsProcess").setIconColor("Positive");e.getView().byId("claimsRpt").setVisible(true);e.getView().byId("claimsRpt").setIcon("sap-icon://expense-report");e.getView().byId("claimsRpt").set+
IconColor("Positive")}else if(t.results[0].ClaimReport==="X"){e.getView().byId("claimsRpt").setVisible(true);e.getView().byId("claimsRpt").setIcon("");e.getView().byId("rpt").setVisibleRowCount(10)}else{e.getView().byId("claimsProcess").setVisible(false)+
;e.getView().byId("claimsRpt").setVisible(false);e.getView().byId("idIconTabBar").setVisible(false);g.error("No authorization to view the Claims")}},error:function(e){g.error("No authorization to view the Claims")}});var i;var a=new Promise(function(e,t)+
{this.getOwnerComponent().getModel().read("/TIMESet",{success:function(t){i=t.results[0].Time*1e3;e()},error:function(e){i="300000";t()}})}.bind(this));a.then(function(e){var t;function a(){clearTimeout(t);t=setTimeout(function(){g.show("Click OK to Refr+
esh",{icon:g.Icon.Error,title:"Session Timeout",onClose:function(e){location.reload()}})},i)}document.onmousemove=a});try{sap.ui.getCore().bp=jQuery.sap.getUriParameters().mParams["sap-data-bp"][0]}catch(e){sap.ui.getCore().bp=""}if(sap.ui.getCore().bp==+
=""){sap.ui.getCore().bp="1000018097"}sap.ui.getCore().shipTo=null;sap.ui.getCore().media=null;sap.ui.getCore().multiMedia=[];this.getTableData();this.getClaimsReasons();this.getClaimsHistory();this.oJsonData=new t([],true);this.getView().setModel(this.o+
JsonData,"sel");var r=this;this._oTPC=new d({table:r.getView().byId("table"),componentName:"demoApp",persoService:u});this._oTPC2=new d({table:r.getView().byId("rpt"),componentName:"demoApp",persoService:u});var o=function(e){var t=e.text;return new sap.+
m.Token({key:t,text:t})};var s=this.getView().byId("multiInput1");s.addValidator(o);var n=this.getView().byId("multiInput2");n.addValidator(o);var l=this.getView().byId("multiInput3");l.addValidator(o);var p=this.getView().byId("multiInput4");p.addValida+
tor(o);var m=new Date;var h=m;var c=365;h=h.setDate(h.getDate()-c);this.getView().byId("IDatefrom").setDateValue(new Date(h));var f=new Date;this.getView().byId("IDateto").setDateValue(f)},onAfterRendering:function(){this.getView().byId("soldtoInput").se+
tValue(sap.ui.getCore().bp)},onUpdateFinished:function(e){},onPress:function(e){this._showObject(e.getSource())},onNavBack:function(){history.go(-1)},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var i=e.g+
etParameter("query");if(i&&i.length>0){t=[new r("ContractNum",o.Contains,i)]}this._applySearch(t)}},onRefresh:function(){var e=this.byId("table");e.getBinding("items").refresh()},_showObject:function(e){},_applySearch:function(e){},getTableData:function(+
){var e=this;e.getView().setBusy(true);var t=new sap.ui.model.Filter({filters:[],and:true});t.aFilters.push(new r("Ismidentcode",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().multiMedia));var a="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";var o=new+
 i(a,{json:true,loadMetadataAsync:true});if(sap.ui.getCore().bp||sap.ui.getCore().shipTo||sap.ui.getCore().media!==null){o.read("/ZREL_ORDERSet",{filters:[this.getInitialFilter(),t],and:true,success:function(t,i){e.getView().setBusy(false);var a=new sap.+
ui.model.json.JSONModel;a.setData(t);sap.ui.getCore().setModel(a);this.getView().setModel(a,"tp");if(sap.ui.getCore().count>5){sap.m.MessageToast.show("Table has been Refreshed Successfully!");sap.ui.getCore().count=" "}}.bind(this),error:function(t){e.g+
etView().setBusy(false);sap.m.MessageToast.show("Error in Fetching Data")}})}else{e.getView().setBusy(false);sap.m.MessageToast.show("Select atleast one of the input filters");var s=[];this.getView().getModel("tp").setData(s)}},getInitialFilter:function(+
){return new r({filters:[new r("SoldTo",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().bp),new r("ShipTo",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().shipTo)],and:true})},getSoldTo:function(){var e="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";va+
r t=new i(e,{json:true,loadMetadataAsync:true});t.read("/SOLDTOSet",{filters:[],success:function(e,t){var i=new sap.ui.model.json.JSONModel;i.setData(e);i.setSizeLimit(2e3);sap.ui.getCore().setModel(i);i.setProperty("/comboBoxValue","");i.setProperty("/c+
omboBoxKey","");this.getView().setModel(i,"sold")}.bind(this),error:function(e){}})},getShipTo:function(){var e="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";var t=new i(e,{json:true,loadMetadataAsync:true});t.read("/ZSHIPTOSet",{filters:[],success:fu+
nction(e,t){var i=new sap.ui.model.json.JSONModel;i.setData(e);i.setSizeLimit(1e3);sap.ui.getCore().setModel(i);this.getView().setModel(i,"ship")}.bind(this),error:function(e){}})},getClaimsHistory:function(){var e="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERV+
ICE_SRV/";var t=new i(e,{json:true,loadMetadataAsync:true});t.read("/ZSROSet",{filters:[],success:function(e,t){var i=new sap.ui.model.json.JSONModel;i.setData(e);sap.ui.getCore().setModel(i);this.getView().setModel(i,"Chart1")}.bind(this),error:function+
(e){}})},getClaimsReasons:function(){var e="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";var t=new i(e,{json:true,loadMetadataAsync:true});var a=new sap.ui.model.Filter("Kunnr",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().bp);t.read("/ReasonsSet",{+
filters:[a],success:function(e,t){var i=new sap.ui.model.json.JSONModel;i.setData(e);sap.ui.getCore().setModel(i);this.getView().setModel(i,"Reason")}.bind(this),error:function(e){}})},getClaimDetails:function(){var e=new sap.ui.model.Filter("RelOrder",s+
ap.ui.model.FilterOperator.EQ,sap.ui.getCore().relorder);var t=new sap.ui.model.Filter("RelItem",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().relitem);var a=new sap.ui.model.Filter("Auart",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().reltype);var r+
=new sap.ui.model.Filter({filters:[e,t,a],and:true});var o="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";var s=new i(o,{json:true,loadMetadataAsync:true});var n=this;s.read("/ZCLM_DETAILSSet",{filters:[r],success:function(e,t){var i=new sap.ui.model.j+
son.JSONModel;i.setData(e);sap.ui.getCore().setModel(i);n.getView().setModel(i,"claims")}.bind(n),error:function(e){}})},getMedia:function(){var e="/sap/opu/odata/sap/ZQTC_REL_ORDER_SERVICE_SRV/";var t=new i(e,{json:true,loadMetadataAsync:true});var a=ne+
w sap.ui.model.Filter("Soldto",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().bp);var r=new sap.ui.model.Filter("Shipto",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().shipTo);var o=new sap.ui.model.Filter("Contract",sap.ui.model.FilterOperator.EQ,sap.+
ui.getCore().contract);var s=new sap.ui.model.Filter("RelOrder",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().order);var n=new sap.ui.model.Filter({filters:[a,r,o,s],and:true});t.read("/ISMCodeSet",{filters:[n],success:function(e,t){var i=new sap.ui.mo+
del.json.JSONModel;i.setData(e);sap.ui.getCore().setModel(i);this.getView().setModel(i,"media")}.bind(this),error:function(e){}})},bpSelected:function(e){},shipToSelected:function(e){},mediaSelected:function(e){},onMainSearch:function(e){var t=e.getParam+
eter("query");t.toUpperCase();var i=new sap.ui.model.Filter("Auart",sap.ui.model.FilterOperator.Contains,t);var a=new sap.ui.model.Filter("RelOrder",sap.ui.model.FilterOperator.Contains,t);var r=new sap.ui.model.Filter("RelItem",sap.ui.model.FilterOperat+
or.Contains,t);var o=new sap.ui.model.Filter("SoldToName",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("Ismidentcode",sap.ui.model.FilterOperator.Contains,t);var n=new sap.ui.model.Filter("ContractNum",sap.ui.model.FilterOperator+
.Contains,t);var l=new sap.ui.model.Filter("ContractItem",sap.ui.model.FilterOperator.Contains,t);var p=new sap.ui.model.Filter("SoldTo",sap.ui.model.FilterOperator.Contains,t);var d=new sap.ui.model.Filter("PurRequisition",sap.ui.model.FilterOperator.Co+
ntains,t);var u=new sap.ui.model.Filter("ShipToName",sap.ui.model.FilterOperator.Contains,t);var g=new sap.ui.model.Filter("ShipTo",sap.ui.model.FilterOperator.Contains,t);var m=new sap.ui.model.Filter("PurOrderDes",sap.ui.model.FilterOperator.Contains,t+
);var h=new sap.ui.model.Filter("PurOrder",sap.ui.model.FilterOperator.Contains,t);var c=new sap.ui.model.Filter("NewClaim",sap.ui.model.FilterOperator.Contains,t);var f=new sap.ui.model.Filter("RecClaim",sap.ui.model.FilterOperator.Contains,t);var w=new+
 sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.Contains,t);var v=this.getView().byId("table");var C=v.getBinding("rows");var y=new sap.ui.model.Filter({filters:[i,a,r,o,p,d,u,g,m,h,s,n,l,c,f,w],and:false});var b=[y];C.filter(b)},processEH:func+
tion(e){var t=this;var i=this.getView().byId("table");var a=i.getSelectedIndices();if(!a.length){return sap.m.MessageBox.warning("Please Select Items To be Processed")}var r=a.map(function(e){var t=i.getContextByIndex(e).getProperty("Vkorg");return new s+
ap.ui.model.Filter("Vkorg",o.EQ,t)});this.reasonFilter=r;t.getView().getModel().read("/ODR_REASONSet",{filters:r,success:t.processEHSuccesss.bind(t),error:t.processEHError});if(!this.processEHDlg){this.processEHDlg=this.loadFragment({name:"zqtc.ZQTC_CLAI+
MS.fragments.processEH",id:"fragProcessEH"})}this.processEHDlg.then(function(e){e.open()}.bind(this));this.btnSource=e.getSource()},processEHSuccesss:function(e,t){this.getView().getModel("processEHModel").setData(t.data.results)},ProcessEHError:function+
(e){},onBeginBtnProcessEH:function(){this.createClaim();this.onEndBthProcessEH()},onEndBthProcessEH:function(e){this.getView().byId("fragProcessEH--dlgProcessEH").close()},inputId:"",fragmento:null,onF4:function(e){this.inputId=e.getSource().getId();if(t+
his.fragmento===null){this.fragmento=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentExcl",this);this.fragmento.bindAggregation("items",{path:"/ODR_REASONSet",parameters:{operationMode:"Default"},filters:this.reasonFilter,template:new sap.m.Display+
ListItem({label:"{Augru}",value:"{Bezei}"})});this.getView().addDependent(this.fragmento)}this.fragmento.open()},handleTableValueHelpConfirm:function(e){var t=e.getParameter("selectedItem");var i=t.getLabel();sap.ui.getCore().byId(this.inputId).setValue(+
i)},onSearchReasonf4:function(e){var t=e.getParameter("itemsBinding");var i=e.getParameter("value");if(!i){t.filter(this.reasonFilter,"Application")}else{var a=new sap.ui.model.Filter({path:"Bezei",operator:o.Contains,value1:i});var r=new sap.ui.model.Fi+
lter({filters:[a],and:true});var s=[r];t.filter(s,"Application")}},suggestReasons:function(e){},createClaim:function(){var e=this.getView().byId("table");var i=e.getModel("tp");var a=i.getData();var r=e.getSelectedIndices();sap.ui.getCore().count=r.lengt+
h;var o=[];var s;var n;var l;var p=this.getView().byId("fragProcessEH--inpProcessEH");var d=p?p.getValue():null;if(!d){sap.m.MessageBox.warning("Please select Order Reason");this.onF4()}for(var u=0;u<r.length;u++){var g=this.getView().byId("table").getCo+
ntextByIndex(r[u]).getObject();s=g.RelOrder;n=g.RelItem;l=g.Auart;o.push({Vbeln:s,Posnr:n,Augru:d,Knkli:g.CountClaim})}var m=this;m.getView().setBusy(true);var h={};h.Vbeln=s;h.NP_VBELN=o;var c=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZQT+
C_REL_ORDER_SERVICE_SRV/");c.create("/CLAIMHEADSet",h,{success:function(e,i){m.getView().setBusy(false);var a=m.getView().byId("table").getSelectedIndices();if(e.Message){sap.m.MessageBox.success(e.Message);if(e.Vbeln){var r=" ";if(e.NP_VBELN.results[0].+
Msg3){for(var o=0;o<e.NP_VBELN.results.length;o++){r=r.concat(" ",e.NP_VBELN.results[o].Msg3)}sap.m.MessageToast.show(r,{duration:9e3,width:"25em"})}}}else{var s=new t;s.setData(e);m.getView().setModel(s,"msg");sap.ui.getCore().setModel(s);if(!m.notifica+
tionPopover){m.oMessageTemplate=new sap.m.MessageItem({type:"{msg>Type}",title:"{msg>Vbeln} {msg>Posnr}",subtitle:"{msg>Posnr}",description:"{msg>Msg1} {msg>Msg2} {msg>Msg3}",text:"{msg>Msg2}",groupName:"abc"})}var n=new sap.m.MessagePopover;n.bindAggreg+
ation("items",{template:m.oMessageTemplate,path:"msg>/NP_VBELN/results"});m.notificationPopover=n;m.getView().addDependent(m.notificationPopover);m.notificationPopover.openBy(m.btnSource)}if(sap.ui.getCore().count>5){m.getView().byId("refreshTab").setVis+
ible(true)}else{if(e.Vbeln){for(var l=0;l<a.length;l++){var p=m.getView().byId("table").getContextByIndex(a[l]).getPath();m.getView().getModel("tp").getProperty(p).NewClaim=e.NP_VBELN.results[l].NewRelOrder;m.getView().getModel("tp").getProperty(p).Count+
Claim=e.NP_VBELN.results[l].Knkli;m.getView().getModel("tp").getProperty(p).Status=e.NP_VBELN.results[l].status;m.getView().getModel("tp").getProperty(p).RecClaim=e.NP_VBELN.results[l].Bedat;m.getView().getModel("tp").getProperty(p).Link=e.NP_VBELN.resul+
ts[l].Link;m.getView().byId("table").getModel("tp").updateBindings(true);m.getView().byId("table").clearSelection()}m.getClaimsHistory();m.getClaimsReasons();m.getView().byId("searchField").setValue("")}}},error:function(e,t){sap.m.MessageBox.error("Erro+
r in Claim Order Creation");m.getView().setBusy(false)}})},handleLoadItems:function(e){},fragment2:null,handleClaims:function(e){sap.ui.getCore().relorder=this.getView().getModel("tp").getProperty("RelOrder",e.getSource().getBindingContext("tp"));sap.ui.+
getCore().relitem=this.getView().getModel("tp").getProperty("RelItem",e.getSource().getBindingContext("tp"));sap.ui.getCore().reltype=this.getView().getModel("tp").getProperty("Auart",e.getSource().getBindingContext("tp"));this.getClaimDetails();if(this.+
fragment2===null){this.fragment2=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentClaims",this);this.getView().addDependent(this.fragment2)}this.fragment2.setTitle("Claim Orders For"+" "+sap.ui.getCore().relorder);this.fragment2.open()},claimConfirm+
:function(){this.fragment2.close()},onPersoButtonPressed:function(e){this._oTPC.openDialog()},downloadExcel:function(){var e=this.getView().byId("table");var t=e.getColumns();var i=[];for(var a=0;a<t.length;a++){var r={name:t[a].getLabel().getText(),temp+
late:{content:{path:t[a].getProperty("filterProperty")}}};i.push(r)}var o=this.getView().getModel("tp");var s=new l({exportType:new p({mimeType:"application/vnd.ms-excel",fileExtension:"xls",separatorChar:"\t",charset:"utf-8"}),models:o,rows:{path:"/resu+
lts"},columns:i});s.saveFile().catch(function(e){sap.m.MessageBox.error("error")}).then(function(){s.destroy()})},resetSort:function(){var e=this.getView().byId("table");e.setEnableGrouping(false);var t=e.getColumns();for(var i=0;i<t.length;i++){t[i].set+
Sorted(false);t[i].setGrouped(false);t[i].setFiltered(false)}var a=e.getBinding();a.aSorters=null;a.aFilters=null;e.getModel("tp").refresh(true);e.setEnableGrouping(true)},Refresh:function(){this.getView().byId("refreshTab").setVisible(false);this.getTab+
leData();this.getClaimsHistory();this.getClaimsReasons();this.getView().byId("searchField").setValue("");sap.m.MessageBox.information("Table will be Refreshed after SAP Job is complete!!")},inputMedia:"",fragmentMedia:null,onProductHelpRequest:function(e+
){this.inputMedia=e.getSource().getId();if(this.fragmentMedia===null){this.fragmentMedia=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentMedia",this);this.fragmentMedia.setTitle("Media Issue Value Help");this.getView().addDependent(this.fragmentMed+
ia)}this.fragmentMedia.open()},handleHelpMediaConfirm:function(e){var t=e.getParameter("selectedItem");var i=t.getLabel();sap.ui.getCore().byId(this.inputMedia).setValue(i);sap.ui.getCore().media=i?i:null},mediaChange:function(e){var t=e.getParameter("ty+
pe");if(t==="removed"||t==="removedAll"){var i=e.getParameter("token").getText();this.getView().getModel("sel").getData().pop({Ismidentcode:i});this.getView().getModel("sel").updateBindings(true);var a=[];var r=this.getView().byId("productInput").getToke+
ns();if(r.length>0){for(var o=0;o<r.length;o++){var s=r[o].getProperty("text");a.push(s)}sap.ui.getCore().multiMedia=a}else{sap.ui.getCore().multiMedia=[];sap.ui.getCore().media=null}this.getTableData()}},searchEH:function(e){var t=e.getParameter("query"+
);var i=new sap.ui.model.Filter("Ismidentcode",sap.ui.model.FilterOperator.EQ,t);var a=sap.ui.getCore().byId("myProdTable");var r=a.getBinding("items");r.filter(i);a.removeSelections(true)},acceptProd:function(e){var t=[];var i=sap.ui.getCore().byId("myS+
elProdTable");var a=i.getItems();if(a.length>0){var r=this.getView().byId("productInput").getTokens();this.getView().byId("productInput").destroyTokens([r]);for(var o=0;o<a.length;o++){var s=a[o].getBindingContext("sel").getProperty("Ismidentcode");var n+
=new sap.m.Token({text:s});this.getView().byId("productInput").addToken(n);sap.ui.getCore().media=s;t.push(s)}sap.ui.getCore().multiMedia=t;sap.ui.getCore().byId("myProdTable").removeSelections(true)}else{r=this.getView().byId("productInput").getTokens()+
;this.getView().byId("productInput").destroyTokens([r]);sap.ui.getCore().media=null;sap.ui.getCore().multiMedia=[]}this.fragmentMedia.close();this.getTableData()},cancelProd:function(){this.fragmentMedia.close()},clearProd:function(){var e=sap.ui.getCore+
().byId("myProdTable");var t=e.getSelectedItems();if(t.length>0){e.removeSelections(true);var i=this.getView().byId("productInput").getTokens();this.getView().byId("productInput").destroyTokens([i]);sap.ui.getCore().multiMedia=[]}this.getView().getModel(+
"sel").setData([]);var a=sap.ui.getCore().byId("mySearch");a.setValue(null)},rowSelectionMedia:function(e){if(e.getParameter("listItems").length>1&&e.getParameter("selected")===true){for(var t=0;t<e.getParameter("listItems").length;t++){var i=e.getParame+
ter("listItems")[t].getBindingContext().getProperty("Ismidentcode");this.getView().getModel("sel").getData().push({Ismidentcode:i});this.getView().getModel("sel").updateBindings(true)}}else{var a=e.getParameter("listItem").getBindingContext().getProperty+
("Ismidentcode");if(e.getParameter("listItem").getProperty("selected")===true){this.getView().getModel("sel").getData().push({Ismidentcode:a});this.getView().getModel("sel").updateBindings(true)}else{this.getView().getModel("sel").getData().pop({Ismident+
code:a});this.getView().getModel("sel").updateBindings(true)}}if(e.getParameter("listItems").length>1&&e.getParameter("selected")===false){this.getView().getModel("sel").setData([])}},deleteSelectionMedia:function(e){var t=e.getParameter("listItem");var +
i=sap.ui.getCore().byId("mySelProdTable");i.removeItem(t)},inputSold:"",fragmentSold:null,onSoldHelpRequest:function(e){this.inputSold=e.getSource().getId();if(this.fragmentSold===null){this.fragmentSold=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.frag+
mentSoldto",this);this.fragmentSold.setTitle("SoldTo Value Help");this.getView().addDependent(this.fragmentSold)}this.fragmentSold.open()},searchEHSold:function(e){var t=e.getParameter("query");var i=new sap.ui.model.Filter("Name1",sap.ui.model.FilterOpe+
rator.EQ,t);var a=sap.ui.getCore().byId("mySoldTable");var r=a.getBinding("items");r.filter(i)},soldToSelect:function(e){var t=e.getParameter("listItem").getBindingContext().getProperty("Kunnr");this.selectedItemSold=t;this.getView().byId("soldtoInput").+
setValue(t);sap.ui.getCore().bp=t;this.getTableData();this.fragmentSold.close();this.getClaimsReasons()},soldToChange:function(e){var t=e.getParameter("value");sap.ui.getCore().bp=t?t:null;if(sap.ui.getCore().bp===null){this.getTableData();this.getClaims+
Reasons()}if(t.length===10){this.getTableData();this.getClaimsReasons()}if(this.selectedItemSold){sap.ui.getCore().byId("mySoldTable").removeSelections(true)}},cancelSold:function(){this.fragmentSold.close()},onSuggest:function(e){var t=e.getParameter("s+
uggestValue");var i=[];if(t){i.push(new r("Name1",o.StartsWith,t))}e.getSource().getBinding("suggestionItems").filter(i)},onSuggestionSoldTo:function(e){var t=e.getParameter("selectedItem");sap.ui.getCore().bp=t.getKey();this.getTableData();this.getClaim+
sReasons()},inputShip:"",fragmentShip:null,onShipHelpRequest:function(e){this.inputSold=e.getSource().getId();if(this.fragmentShip===null){this.fragmentShip=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentShipto",this);this.fragmentShip.setTitle("S+
hipTo Value Help");this.getView().addDependent(this.fragmentShip)}this.fragmentShip.open()},searchEHShip:function(e){var t=e.getParameter("query");var i=new sap.ui.model.Filter("Name1",sap.ui.model.FilterOperator.EQ,t);var a=sap.ui.getCore().byId("myShip+
Table");var r=a.getBinding("items");r.filter(i)},shipToSelect:function(e){var t=e.getParameter("listItem").getBindingContext().getProperty("Shipto");this.selectedItemShip=t;this.getView().byId("shiptoInput").setValue(t);sap.ui.getCore().shipTo=t;this.fra+
gmentShip.close();this.getTableData()},shipToChange:function(e){var t=e.getParameter("value");sap.ui.getCore().shipTo=t?t:null;if(sap.ui.getCore().shipTo===null){this.getTableData()}if(t.length===10){this.getTableData()}if(this.selectedItemShip){sap.ui.g+
etCore().byId("myShipTable").removeSelections(true)}},cancelShip:function(){this.fragmentShip.close()},onSuggestShip:function(e){var t=e.getParameter("suggestValue");var i=[];if(t){i.push(new r("Name1",o.StartsWith,t))}e.getSource().getBinding("suggestio+
nItems").filter(i)},onSuggestionShipTo:function(e){var t=e.getParameter("selectedItem");sap.ui.getCore().shipTo=t.getKey();this.getTableData()},filterTable:function(){this.getTableData()},colorFormatter:function(e){return e==="Complete"?"Success":"Error"+
},onFilterSelect:function(e){},panelText:function(e){if(e.getParameter("expand")==true){this.getView().byId("panel").setHeaderText("Claims Statistics");this.getView().byId("tableText").setVisible(true)}else{this.getView().byId("panel").setHeaderText("Lis+
t Of Release Orders");this.getView().byId("tableText").setVisible(false)}},helpSoldtoRpt:function(e){var t=e.getSource().getValue(),i=this.getView();if(!this.pValueHelpDialog){this.pValueHelpDialog=m.load({id:"soldtoRpt",name:"zqtc.ZQTC_CLAIMS.view.fragm+
entSoldtoRpt",controller:this}).then(function(e){i.addDependent(e);return e})}this.pValueHelpDialog.then(function(e){if(t){var i=new r("Name1",o.Contains,t);e.getBinding("items").filter([i])}e.open(t)})},handleSoldToRptSearch:function(e){var t=e.getParam+
eter("value");var i=new r("Name1",o.EQ,t);e.getSource().getBinding("items").filter([i])},handleSoldToRptClose:function(e){var t=e.getParameter("selectedItems"),i=this.getView().byId("multiInput3");if(t&&t.length>0){t.forEach(function(e){i.addToken(new sa+
p.m.Token({text:e.getTitle()}))})}},helpShiptoRpt:function(e){var t=this;var i=e.getSource().getValue(),a=this.getView();if(!this.sValueHelpDialog){this.sValueHelpDialog=m.load({id:"shiptoRpt",name:"zqtc.ZQTC_CLAIMS.view.fragmentShiptoRpt",controller:thi+
s}).then(function(e){a.addDependent(e);return e})}t.getView().setBusy(false);this.sValueHelpDialog.then(function(e){if(i){var t=new r("Name1",o.Contains,i);e.getBinding("items").filter([t])}e.open(i)})},handleShipToRptSearch:function(e){var t=e.getParame+
ter("value");var i=new r("Name1",o.EQ,t);e.getSource().getBinding("items").filter([i])},handleShipToRptClose:function(e){var t=e.getParameter("selectedItems"),i=this.getView().byId("multiInput4");if(t&&t.length>0){t.forEach(function(e){i.addToken(new sap+
.m.Token({text:e.getTitle()}))})}},helpCtryRpt:function(e){var t=e.getSource().getValue(),i=this.getView();if(!this.cValueHelpDialog){this.cValueHelpDialog=m.load({id:"cntryRpt",name:"zqtc.ZQTC_CLAIMS.view.fragmentShipCtry",controller:this}).then(functio+
n(e){i.addDependent(e);return e})}this.cValueHelpDialog.then(function(e){e.open(t)})},handleCtryRptSearch:function(e){var t=e.getParameter("value");var i=new r("Landx",o.EQ,t);e.getSource().getBinding("items").filter([i])},handleCtryRptClose:function(e){+
var t=e.getParameter("selectedItems"),i=this.getView().byId("multiInput2");if(t&&t.length>0){t.forEach(function(e){i.addToken(new sap.m.Token({text:e.getTitle()}))})}},soldToRptTab:function(e){var t=e.getSource().getBindingContext("rpt").getPath();if(!th+
is.fragmentSoldToAdd){this.fragmentSoldToAdd=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentSoldtoAddRpt",this);this.getView().addDependent(this.fragmentSoldToAdd)}this.fragmentSoldToAdd.setTitle("SoldTo-Party Address");sap.ui.getCore().byId("Simp+
leFormAdd1").bindElement({path:t,model:"rpt"});this.fragmentSoldToAdd.open()},cancelAdd1:function(){this.fragmentSoldToAdd.close()},shipToRptTab:function(e){var t=e.getSource().getBindingContext("rpt").getPath();if(!this.fragmentShipToAdd){this.fragmentS+
hipToAdd=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentShiptoAddRpt",this);this.getView().addDependent(this.fragmentShipToAdd)}this.fragmentShipToAdd.setTitle("ShipTo-Party Address");sap.ui.getCore().byId("SimpleFormAdd2").bindElement({path:t,mod+
el:"rpt"});this.fragmentShipToAdd.open()},cancelAdd2:function(){this.fragmentShipToAdd.close()},fwdRptTab:function(e){var t=e.getSource().getBindingContext("rpt").getPath();if(!this.fragmentfwdToAdd){this.fragmentfwdToAdd=new sap.ui.xmlfragment("zqtc.ZQT+
C_CLAIMS.view.fragmentFwdAddRpt",this);this.getView().addDependent(this.fragmentfwdToAdd)}this.fragmentfwdToAdd.setTitle("Forwarding Agent Address");sap.ui.getCore().byId("SimpleFormAdd3").bindElement({path:t,model:"rpt"});this.fragmentfwdToAdd.open()},c+
ancelAdd3:function(){this.fragmentfwdToAdd.close()},issueRptTab:function(e){var t=e.getSource().getBindingContext("rpt").getProperty("Matnr");var i=e.getSource().getBindingContext("rpt").getPath();if(!this.fragmentIssueAdd){this.fragmentIssueAdd=new sap.+
ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentIssueRpt",this);this.getView().addDependent(this.fragmentIssueAdd)}this.fragmentIssueAdd.setTitle("Media Issue:"+""+t);sap.ui.getCore().byId("SimpleFormAdd4").bindElement({path:i,model:"rpt"});this.fragmentIs+
sueAdd.open()},cancelAdd4:function(){this.fragmentIssueAdd.close()},claimsRptTab:function(e){var t=e.getSource().getBindingContext("rpt").getPath();var i=e.getSource().getBindingContext("rpt").getProperty("Vbeln");if(!this.fragmentDeladd){this.fragmentDe+
ladd=new sap.ui.xmlfragment("zqtc.ZQTC_CLAIMS.view.fragmentDelRpt",this);this.getView().addDependent(this.fragmentDeladd)}this.fragmentDeladd.setTitle("Claim:"+i+" "+"Delivery Details");sap.ui.getCore().byId("SimpleFormAdd5").bindElement({path:t,model:"r+
pt"});this.fragmentDeladd.open()},cancelAdd5:function(){this.fragmentDeladd.close()},refreshRpt:function(e){var t=this.getView().byId("IDatefrom").getValue();var i=this.getView().byId("IDateto").getValue();if(!t){t=null}if(!i){i=null}var a=this.getView()+
.byId("IDatefrom2").getValue();if(!a){a=null}var r=this.getView().byId("IDateto2").getValue();if(!r){r=null}sap.ui.getCore().enddate=this.getView().byId("IDateto").getValue();var o=this.getView().byId("multiInput1").getTokens();var s=this.getView().byId(+
"multiInput2").getTokens();var n=this.getView().byId("multiInput3").getTokens();var l=this.getView().byId("multiInput4").getTokens();var p=[],d=[],u=[],g=[];if(o.length>0){for(var m=0;m<o.length;m++){var h=o[m].getProperty("text");p.push(h)}}if(s.length>+
0){for(var c=0;c<s.length;c++){var f=s[c].getProperty("text");d.push(f)}}if(n.length>0){for(var w=0;w<n.length;w++){var v=n[w].getProperty("text");u.push(v)}}if(l.length>0){for(var C=0;C<l.length;C++){var y=l[C].getProperty("text");g.push(y)}}var b=new s+
ap.ui.model.Filter("Ernam",sap.ui.model.FilterOperator.EQ,p);var S=new sap.ui.model.Filter("Land1",sap.ui.model.FilterOperator.EQ,d);var I=new sap.ui.model.Filter("Kunnr",sap.ui.model.FilterOperator.EQ,u);var V=new sap.ui.model.Filter("Kunwe",sap.ui.mode+
l.FilterOperator.EQ,g);var T=new sap.ui.model.Filter({path:"Erdat",operator:sap.ui.model.FilterOperator.BT,value1:t,value2:i});var F=new sap.ui.model.Filter({path:"WadatIst",operator:sap.ui.model.FilterOperator.BT,value1:a,value2:r});var P=new sap.ui.mod+
el.Filter({filters:[b,S,I,V,T,F],and:true});var E=this.getOwnerComponent().getModel();var M=this;M.getView().setBusy(true);E.read("/ClaimReportSet",{filters:[P],success:function(e,t){M.getView().setBusy(false);var i=new sap.ui.model.json.JSONModel;i.setD+
ata(e);sap.ui.getCore().setModel(i);M.getView().setModel(i,"rpt");var a=e.results.length;M.getView().byId("count").setValue(a);if(a===0){sap.m.MessageBox.information("No data for the given selection")}},error:function(e){M.getView().setBusy(false);sap.m.+
MessageBox.error("No data for the given selection")}})},createColumnConfig:function(){return[{label:"Claim",property:"Vbeln",type:f.Number,scale:0},{label:"Delivery",property:"VbelnVl",type:f.Number,width:"10"},{label:"Purchase Req.",property:"Banfn",typ+
e:f.Number,width:"10"},{label:"PO",property:"Ebeln",type:f.Number,width:"10"},{label:"Material Doc.",property:"Mblnr",type:f.Number,width:"10"},{label:"Claim Item",property:"Posnr",type:f.Number,width:"5"},{label:"Media Issue",property:"Matnr",type:f.Str+
ing,width:"18"},{label:"Journal Acronym",property:"Extwg",width:"10"},{label:"Volume",property:"Ismcopynr",type:f.Number,width:"10"},{label:"Journal Name",property:"Arktx",type:f.String,width:"18"},{label:"Reason for Rejection",property:"ReasonRej",type:+
f.String,width:"18"},{label:"Customer Grp1",property:"Kvgr1_Text",type:f.String,width:"18"},{label:"SoldTo-Party",property:"Kunnr",type:f.Number,width:"10"},{label:"SoldTo-Name1",property:"AG_Name1",type:f.String,width:"25"},{label:"SoldTo-Name2",propert+
y:"AG_Name2",type:f.String,width:"25"},{label:"SoldTo-Country",property:"AG_Land1",type:f.String,width:"5"},{label:"SoldTo-Phone",property:"AG_TEL",type:f.String,width:"40"},{label:"SoldTo-Email",property:"AG_Email",type:f.String,width:"40"},{label:"Ship+
To-Party",property:"Kunwe",type:f.Number,width:"10"},{label:"ShipTo-Name1",property:"WE_Name1",type:f.String,width:"25"},{label:"ShipTo-Name2",property:"WE_Name2",type:f.String,width:"25"},{label:"ShipTo-Cntry",property:"WE_Land1",type:f.String,width:"5"+
},{label:"ShipTo-Region",property:"WE_Region",type:f.String,width:"5"},{label:"ShipTo-Phone",property:"WE_Tel",type:f.String,width:"12"},{label:"ShipTo-Email",property:"WE_Email",type:f.String,width:"40"},{label:"Forwarding Agent",property:"Lifnr",type:f+
.Number,width:"10"},{label:"FWD-Name1",property:"SP_Name1",type:f.String,width:"25"},{label:"FWD-Name2",property:"SP_Name2",type:f.String,width:"25"},{label:"FWD-Cntry",property:"SP_Land1",type:f.String,width:"5"},{label:"Claim Raised Date",property:"Erd+
at",type:f.String,width:"10"},{label:" ML count",property:"Sub_Count",type:f.Number,textAlign:"begin",width:"10"},{label:"OrderReason",property:"Bezei",type:f.String,width:"18"},{label:"Qty",property:"Kwmeng",type:f.Number,textAlign:"begin",width:"10"},{+
label:"Approver",property:"Ernam",type:f.String,width:"12"},{label:"Claim Processed Date",property:"WadatIst",type:f.String,width:"10"},{label:"Item Category",property:"Vtext",type:f.String,width:"18"},{label:"Claim Status",property:"Status",type:f.Strin+
g,width:"18"},{label:"Release Order",property:"Vgbel",type:f.Number,width:"10"},{label:"RelOrderItem",property:"Vgpos",type:f.Number,width:"10"}]},downloadExcelRpt:function(){var e,t,i,a;e=this.createColumnConfig();t=this.getView().getModel("rpt").getPro+
perty("/results");i={workbook:{columns:e},dataSource:t};a=new c(i);a.build().then(function(){sap.m.MessageToast.show("Excel download has finished")}).finally(a.destroy)},onPersoButtonPressedRpt:function(e){this._oTPC2.openDialog()},onRptSearch:function(e+
){var t=e.getParameter("query");t.toUpperCase();var i=new sap.ui.model.Filter("Vbeln",sap.ui.model.FilterOperator.Contains,t);var a=new sap.ui.model.Filter("Posnr",sap.ui.model.FilterOperator.Contains,t);var r=new sap.ui.model.Filter("Ismcopynr",sap.ui.m+
odel.FilterOperator.Contains,t);var o=new sap.ui.model.Filter("Extwg",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("Matnr",sap.ui.model.FilterOperator.Contains,t);var n=new sap.ui.model.Filter("Arktx",sap.ui.model.FilterOperator.+
Contains,t);var l=new sap.ui.model.Filter("Kvgr1_Text",sap.ui.model.FilterOperator.Contains,t);var p=new sap.ui.model.Filter("Kunnr",sap.ui.model.FilterOperator.Contains,t);var d=new sap.ui.model.Filter("Kunwe",sap.ui.model.FilterOperator.Contains,t);var+
 u=new sap.ui.model.Filter("Lifnr",sap.ui.model.FilterOperator.Contains,t);var g=new sap.ui.model.Filter("Erdat",sap.ui.model.FilterOperator.Contains,t);var m=new sap.ui.model.Filter("Sub_Count",sap.ui.model.FilterOperator.Contains,t);var h=new sap.ui.mo+
del.Filter("Bezei",sap.ui.model.FilterOperator.Contains,t);var c=new sap.ui.model.Filter("Kwmeng",sap.ui.model.FilterOperator.Contains,t);var f=new sap.ui.model.Filter("Ernam",sap.ui.model.FilterOperator.Contains,t);var w=new sap.ui.model.Filter("WadatIs+
t",sap.ui.model.FilterOperator.Contains,t);var v=new sap.ui.model.Filter("Pstyv",sap.ui.model.FilterOperator.Contains,t);var C=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.Contains,t);var y=new sap.ui.model.Filter("Vgbel",sap.ui.model.Fil+
terOperator.Contains,t);var b=new sap.ui.model.Filter("Vgpos",sap.ui.model.FilterOperator.Contains,t);var S=new sap.ui.model.Filter("VbelnVl",sap.ui.model.FilterOperator.Contains,t);var I=new sap.ui.model.Filter("Banfn",sap.ui.model.FilterOperator.Contai+
ns,t);var V=new sap.ui.model.Filter("Ebeln",sap.ui.model.FilterOperator.Contains,t);var T=new sap.ui.model.Filter("AG_Name1",sap.ui.model.FilterOperator.Contains,t);var F=new sap.ui.model.Filter("WE_Name1",sap.ui.model.FilterOperator.Contains,t);var P=ne+
w sap.ui.model.Filter("AG_Email",sap.ui.model.FilterOperator.Contains,t);var E=new sap.ui.model.Filter("AG_Name2",sap.ui.model.FilterOperator.Contains,t);var M=new sap.ui.model.Filter("AG_Land1",sap.ui.model.FilterOperator.Contains,t);var R=new sap.ui.mo+
del.Filter("WE_Name2",sap.ui.model.FilterOperator.Contains,t);var O=new sap.ui.model.Filter("WE_Email",sap.ui.model.FilterOperator.Contains,t);var D=new sap.ui.model.Filter("WE_Land1",sap.ui.model.FilterOperator.Contains,t);var A=new sap.ui.model.Filter(+
"AG_TEL",sap.ui.model.FilterOperator.Contains,t);var _=new sap.ui.model.Filter("WE_Tel",sap.ui.model.FilterOperator.Contains,t);var B=new sap.ui.model.Filter("WE_Region",sap.ui.model.FilterOperator.Contains,t);var x=this.getView().byId("rpt");var N=x.get+
Binding("rows");var L=new sap.ui.model.Filter({filters:[i,a,r,o,p,d,u,g,m,h,s,n,l,c,f,w,v,C,y,b,b,S,I,V,T,F,P,E,M,R,O,D,A,_,B],and:false});var Q=[L];N.filter(Q);var H=N.getLength();this.getView().byId("count").setValue(H)}})});                            