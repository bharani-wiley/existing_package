sap.ui.define([                                                                                                                                                                                                                                                
	"sap/ui/core/mvc/Controller",                                                                                                                                                                                                                                 
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"fiori/model/formatter",                                                                                                                                                                                                                                      
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	'sap/ui/model/BindingMode',                                                                                                                                                                                                                                   
	'sap/viz/ui5/data/FlattenedDataset',                                                                                                                                                                                                                          
	'sap/viz/ui5/format/ChartFormatter',                                                                                                                                                                                                                          
	'sap/viz/ui5/api/env/Format',                                                                                                                                                                                                                                 
	"sap/ui/core/routing/History"                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
], function(Controller, JSONModel, formatter, Filter, FilterOperator, BindingMode, FlattenedDataset, ChartFormatter, Format, History) {                                                                                                                        
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return Controller.extend("fiori.controller.epicscreen", {                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when a controller is instantiated and its View controls (if available) are already created.                                                                                                                                                        
		 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.                                                                                                                                       
		 * @memberOf fiori.view.epicscreen                                                                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		onInit: function() {                                                                                                                                                                                                                                         
			//		sap.ui.getCore().setModel(oJSONModel);                                                                                                                                                                                                                  
			//sap.ui.getCore().setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                         
		                                                                                                                                                                                                                                                             
			//this._onObjectMatched();                                                                                                                                                                                                                                  
			this.getOwnerComponent().getRouter().getRoute("epicscreen").attachPatternMatched(this._onObjectMatched, this);                                                                                                                                              
                                                                                                                                                                                                                                                               
			//	this.getRouter().getRoute("epicscreen").attachPatternMatched(this._onObjectMatched, this);                                                                                                                                                               
			// 			var oTable2 = this.getView().byId("sprinttable2");                                                                                                                                                                                                    
			// 				var sUrl = "/sap/opu/odata/sap/ZCA_TRLOG_ANALYTICS_SRV/";&nbsp;                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			// 			var oFilter = new sap.ui.model.Filter({                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			// 			 filters: [&nbsp;                                                                                                                                                                                                                                     
			// 			 	//filter1, filter2                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// 			 		new sap.ui.model.Filter("Sprint", sap.ui.model.FilterOperator.EQ, sap.ui.getCore().cItem),                                                                                                                                                         
			// 	        	    new sap.ui.model.Filter("Chgreq", sap.ui.model.FilterOperator.EQ, sap.ui.getCore().cReq )                                                                                                                                                  
			// 	        	    ],                                                                                                                                                                                                                                         
			// 				and: true&nbsp;                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			// 			});&nbsp;                                                                                                                                                                                                                                             
			// //	sap.ui.getCore().oFilter();                                                                                                                                                                                                                           
			//   debugger;                                                                                                                                                                                                                                              
			// 	var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                           
			// 				json: true,                                                                                                                                                                                                                                          
			// 				loadMetadataAsync: true                                                                                                                                                                                                                              
			// 			});                                                                                                                                                                                                                                                   
			// //debugger                                                                                                                                                                                                                                               
			// 			oDataModel.read("/sprint2Set", {                                                                                                                                                                                                                      
			// 			//	filters : [filter1,filter2]&nbsp;&nbsp;                                                                                                                                                                                                            
			// 				filters: [oFilter], //[filters],//&nbsp;                                                                                                                                                                                                             
			// 				success: function(oData, response) {                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			// 		var oJSONModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                    
			// 	//	this.onInit();                                                                                                                                                                                                                                       
			// 				//var  dataobject = {};                                                                                                                                                                                                                              
			// 				//dataobject  = oData;                                                                                                                                                                                                                               
			// 			    		oJSONModel.setData(oData);		                                                                                                                                                                                                                    
			// 				//	oJSONModel.setData(dataobject);                                                                                                                                                                                                                   
			// 						//this.getView().setData(oData);                                                                                                                                                                                                                   
			// 				//	sap.ui.getCore().setModel(oJSONModel);                                                                                                                                                                                                            
			// 				//	this.getView().setModel(oJSONModel);                                                                                                                                                                                                              
			// 				   //this.setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                           
			// 				//	this.getOwnerComponent().setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                         
			// 				oTable2.setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			// 				//	sap.ui.getCore().setModel(oJSONModel);                                                                                                                                                                                                            
			// 				//sap.ui.getCore().setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// 				//	this.getView().setModel(oJSONModel);                                                                                                                                                                                                              
			// 			     // this.setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                         
			// 								sap.m.MessageToast.show("Data Read Successfully");                                                                                                                                                                                               
			// 					//oJSONModel.bindList("items");                                                                                                                                                                                                                     
			// 					this.getView().setBusy(false);                                                                                                                                                                                                                      
			// 				}.bind(this),                                                                                                                                                                                                                                        
			// 				error: function(oError) {                                                                                                                                                                                                                            
			// 					sap.m.MessageToast.show("Data Read error + oError.responseText");                                                                                                                                                                                   
			// 				}                                                                                                                                                                                                                                                    
			// 			});	                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered                                                                                                                                                         
		 * (NOT before the first rendering! onInit() is used for that one!).                                                                                                                                                                                         
		 * @memberOf fiori.view.epicscreen                                                                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		_onBeforeRendering: function() {                                                                                                                                                                                                                             
		                                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.                                                                                                                
		 * This hook is the same one that SAPUI5 controls get after being rendered.                                                                                                                                                                                  
		 * @memberOf fiori.view.epicscreen                                                                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		onAfterRendering: function() {                                                                                                                                                                                                                               
		                                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the Controller is destroyed. Use this one to free resources and finalize activities.                                                                                                                                                          
		 * @memberOf fiori.view.epicscreen                                                                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		onExit: function() {                                                                                                                                                                                                                                         
		                                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		Back3: function() {                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// var sPreviousHash = History.getInstance().getPreviousHash(),                                                                                                                                                                                             
			// 	oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			// if (sPreviousHash !== undefined || !oCrossAppNavigator.isInitialNavigation()) {                                                                                                                                                                          
			// 	history.go(-1);                                                                                                                                                                                                                                         
			// } else {                                                                                                                                                                                                                                                 
			this.getOwnerComponent().getRouter().navTo("worklist", {}, true);                                                                                                                                                                                           
			// }                                                                                                                                                                                                                                                        
		                                                                                                                                                                                                                                                             
			                                                                                                                                                                                                                                                            
		},                                                                                                                                                                                                                                                           
		                                                                                                                                                                                                                                                             
		nextTREH: function(oEvent) {                                                                                                                                                                                                                                 
			                                                                                                                                                                                                                                                            
			var epic = [];                                                                                                                                                                                                                                              
			sap.ui.getCore().epic = [];                                                                                                                                                                                                                                 
			var oTable = this.getView().byId("sprinttable2");                                                                                                                                                                                                           
			var items   = oTable.getSelectedContextPaths();                                                                                                                                                                                                             
			var modelo = this.getView().getModel("SPRINT2");                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			for (var i = 0; i < items.length; i++) {                                                                                                                                                                                                                    
				                                                                                                                                                                                                                                                           
				var value = modelo.getProperty(items[i]).Epic;                                                                                                                                                                                                             
				epic.push(value);                                                                                                                                                                                                                                          
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			sap.ui.getCore().epic = epic;                                                                                                                                                                                                                               
		                                                                                                                                                                                                                                                             
			this.getOwnerComponent().getRouter().navTo("transportscreen", {}, false);                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		totalrecordsEH: function(oEvent) {                                                                                                                                                                                                                           
		                                                                                                                                                                                                                                                             
			var recordcount = oEvent.getParameter("total");                                                                                                                                                                                                             
			var tableref = this.getView().byId("sprinttable2");                                                                                                                                                                                                         
			tableref.setHeaderText("Total EPIC Search Records:" + recordcount);                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		selectEH: function() {                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			var oTable = this.getView().byId("sprinttable2"); //reading                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			var oModel2 = oTable.getModel(); // get the table model                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			var aRows = oModel2.getData(); //read the data from the model                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			var aContexts = oTable.getSelectedContexts(); //finding the checked item                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			sap.m.MessageToast.show(aContexts.length + " " + "row(s) selected.");                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		                                                                                                                                                                                                                                                             
		_onObjectMatched: function(oEvent) {                                                                                                                                                                                                                         
			                                                                                                                                                                                                                                                            
			var oTable2 = this.getView().byId("sprinttable2");                                                                                                                                                                                                          
			var sUrl = "/sap/opu/odata/sap/ZCA_TRLOG_ANALYTICS_SRV/";                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
	                                                                                                                                                                                                                                                              
			var oFilter = new sap.ui.model.Filter({                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				filters: [	],                                                                                                                                                                                                                                              
				and: true                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
			if (sap.ui.getCore().cItem.length > 0) {                                                                                                                                                                                                                    
				oFilter.aFilters.push(new sap.ui.model.Filter("Sprint", sap.ui.model.FilterOperator.EQ, sap.ui.getCore().cItem));                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			if (sap.ui.getCore().cItem.length > 0) {                                                                                                                                                                                                                    
				oFilter.aFilters.push(new sap.ui.model.Filter("Chgreq", sap.ui.model.FilterOperator.EQ, sap.ui.getCore().cReq));                                                                                                                                           
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                               
				json: true,                                                                                                                                                                                                                                                
				loadMetadataAsync: true                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
           var that = this;                                                                                                                                                                                                                                    
			oDataModel.read("/sprint2Set", {                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function(oData, response) {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					var oJSONModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                       
					oJSONModel.setData(oData);                                                                                                                                                                                                                                
					//oTable2.                                                                                                                                                                                                                                                
						that.getView().setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                          
					sap.m.MessageToast.show("Data Read Successfully");                                                                                                                                                                                                        
					this.getView().setBusy(false);                                                                                                                                                                                                                            
				}.bind(this),                                                                                                                                                                                                                                              
				error: function(oError) {                                                                                                                                                                                                                                  
					sap.m.MessageToast.show("Data Read error + oError.responseText");                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		                                                                                                                                                                                                                                                             
		GET4EH: function()                                                                                                                                                                                                                                           
		{                                                                                                                                                                                                                                                            
		                                                                                                                                                                                                                                                             
			if (this.getView().byId("jira").getSelectedItems().length > 0) {                                                                                                                                                                                            
				var jiraref = this.getView().byId("jira").getSelectedItems();                                                                                                                                                                                              
				                                                                                                                                                                                                                                                           
				var jiraarray = [];                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				for (var i = 0; i <= jiraref.length; i++) {                                                                                                                                                                                                                
					var item = jiraref[i];                                                                                                                                                                                                                                    
					if (item !== undefined) {                                                                                                                                                                                                                                 
						var context = item.getBindingContext();                                                                                                                                                                                                                  
						var value = context.getProperty("Epic");                                                                                                                                                                                                                 
						jiraarray.push(value);                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}	                                                                                                                                                                                                                                                          
			                                                                                                                                                                                                                                                            
			if (this.getView().byId("Sprint").getSelectedItems().length > 0) {                                                                                                                                                                                          
				var Sprintref = this.getView().byId("Sprint").getSelectedItems();                                                                                                                                                                                          
				                                                                                                                                                                                                                                                           
				var Sprintarray = [];                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
				for (var i = 0; i <= Sprintref.length; i++) {                                                                                                                                                                                                              
					var item = Sprintref[i];                                                                                                                                                                                                                                  
					if (item !== undefined) {                                                                                                                                                                                                                                 
						var context = item.getBindingContext();                                                                                                                                                                                                                  
						var value = context.getProperty("Sprint");                                                                                                                                                                                                               
						Sprintarray.push(value);                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			                                                                                                                                                                                                                                                            
			if (this.getView().byId("CR").getSelectedItems().length > 0) {                                                                                                                                                                                              
				var CRref = this.getView().byId("CR").getSelectedItems();                                                                                                                                                                                                  
				                                                                                                                                                                                                                                                           
				var CRarray = [];                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				for (var i = 0; i <= CRref.length; i++) {                                                                                                                                                                                                                  
					var item = CRref[i];                                                                                                                                                                                                                                      
					if (item !== undefined) {                                                                                                                                                                                                                                 
						var context = item.getBindingContext();                                                                                                                                                                                                                  
						var value = context.getProperty("Chgreq");                                                                                                                                                                                                               
						CRarray.push(value);                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			                                                                                                                                                                                                                                                            
			                                                                                                                                                                                                                                                            
			var oTable = this.getView().byId("sprinttable");                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			var sUrl = "/sap/opu/odata/sap/ZCA_TRLOG_ANALYTICS_SRV/";                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			var oFilter = new sap.ui.model.Filter({                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				filters: [],                                                                                                                                                                                                                                               
				and: true                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
			                                                                                                                                                                                                                                                            
	                                                                                                                                                                                                                                                              
			if (this.getView().byId("Sprint").getSelectedItems().length > 0) {                                                                                                                                                                                          
				oFilter.aFilters.push(new sap.ui.model.Filter("Sprint", sap.ui.model.FilterOperator.EQ, Sprintarray));                                                                                                                                                     
			}                                                                                                                                                                                                                                                           
			if (this.getView().byId("CR").getSelectedItems().length > 0) {                                                                                                                                                                                              
				oFilter.aFilters.push(new sap.ui.model.Filter("Chgreq", sap.ui.model.FilterOperator.EQ, CRarray));                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (this.getView().byId("jira").getSelectedItems().length > 0) {                                                                                                                                                                                            
				oFilter.aFilters.push(new sap.ui.model.Filter("Epic", sap.ui.model.FilterOperator.EQ, jiraarray));                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                               
				json: true,                                                                                                                                                                                                                                                
				loadMetadataAsync: true                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
			var oJSONModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                         
			var that = this;                                                                                                                                                                                                                                            
			oDataModel.read("/sprint2Set", {                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function(oData, response) {                                                                                                                                                                                                                       
					var DataObject = {};                                                                                                                                                                                                                                      
					DataObject = oData;                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					oJSONModel.setData(DataObject);                                                                                                                                                                                                                           
					//	oTable.setModel(oJSONModel, "Sprint1");                                                                                                                                                                                                                
					that.getView().setModel(oJSONModel, "SPRINT2");                                                                                                                                                                                                           
					sap.m.MessageToast.show("Data Read Successfully");                                                                                                                                                                                                        
					this.getView().setBusy(false);                                                                                                                                                                                                                            
				}.bind(this),                                                                                                                                                                                                                                              
				error: function(oError) {                                                                                                                                                                                                                                  
					sap.m.MessageToast.show("Data Read error + oError.responseText");                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			return oJSONModel;                                                                                                                                                                                                                                          
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            