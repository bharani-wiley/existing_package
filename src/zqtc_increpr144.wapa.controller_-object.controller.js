sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/m/Token","sap/ui/export/Spreadsheet","sap/ui/export/library+
","sap/ui/util/Storage"],function(e,t,i,n,o,r,a,s,l,u,g){"use strict";var d=u.EdmType;return e.extend("ir.ZE144_IncompletionReport.controller.Object",{formatter:n,onInit:function(){var e,i=new t({busy:true,delay:0});this.getRouter().getRoute("object").at+
tachPatternMatched(this._onObjectMatched,this);e=this.getView().getBusyIndicatorDelay();this.setModel(i,"objectView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){i.setProperty("/delay",e)})},onNavBack:function(){var e=i.getInstan+
ce().getPreviousHash();if(e!==undefined){history.go(-1)}else{this.getRouter().navTo("worklist",{},true)}},onExcelDownlaod:function(){var e=this.getView().byId("tblIncompReport");var t=e.getBinding("rows").getContexts().map(function(e){return e.getObject(+
)});var i=e.getColumns();var n=[];i.forEach(function(e){var t=e.getAggregation("label").getText();if(t!=="Items"&&t!=="Incompleted Items"){n.push({label:e.getAggregation("label").getText(),property:e.getSortProperty()})}});var o={workbook:{columns:n},dat+
aSource:t,fileName:"IncompleteOrders.xlsx"};var r=new sap.ui.export.Spreadsheet(o);r.build()},filterGlobally:function(e){var t=e.getParameter("query");var i=this.getView().byId("tbltitle");this._oGlobalFilter=null;var n=["VBELN","SMODEL","BSTNK","AUART",+
"PSTAT","VKORG","VKBUR","KUNNR","NAME","AUGRU","ZMENG","MWSBP","NETWR","WAERK","VBBK0004","MVGR5","ZZVYP","BSARK","KDKG2","KONDA","FAKSK","FAKSKT","LIFSK","LIFSKT","GBSTK","GBSTA","ZLSCH","ZTERM","ZZSUBTYP","ERDAT","ERNAM","AGADDR","AGEMAIL","AGSTREET","+
AGCITY","AGSTATE","AGPOSTAL","AGCOUNTRY","WEBP","WENAME","WEEMAIL","WESTREET","WECITY","WESTATE","WEPOSTAL","WECOUNTRY","ZABP","ZANAME","MODEL","FDNAM"];if(t){var a=n.map(function(e){return new o(e,r.Contains,t)});this._oGlobalFilter=new o(a,false)}this.+
getView().byId("tblIncompReport").getBinding().filter(this._oGlobalFilter,"Application");var s=this.getView().byId("tblIncompReport").getBinding().iLength;i.setText("Incompletion Orders "+"("+s+")")},onGO:function(e){var t=this.getView().byId("idMIIncomp+
Log");var i=t.getTokens();if(i.length){var n=this._addCreateFilters();var a=i.map(function(e){return new o("FDNAM",r.EQ,e.getKey())});var s=new o(a);n.push(s);this.getView().getModel().read("/HeaderSet",{filters:n,success:function(e,t){this.getView().get+
Model("tableModel").setData(e.results)}.bind(this),error:function(e){}})}else{this.getView().getModel().read("/HeaderSet",{filters:this._addCreateFilters(),success:function(e,t){this.getView().getModel("tableModel").setData(e.results)}.bind(this),error:f+
unction(e){}})}},onShowItems:function(e,t){this.oBtnSrc=e.getSource();var i=this;i.getView().setBusy(true);var n;var s=this.getView();var l=this.getView().getModel();this.oVBELN=e.getSource().getBindingContext("tableModel").getProperty("VBELN");var u=new+
 o("VBELN",r.EQ,this.oVBELN);if(t==="C"){n=new o([u,new o("VAR",r.EQ,t)],true)}else{n=new o([u,new o("VAR",r.EQ,t)],true)}var g=new Promise(function(e,t){l.read("/ItemsSet",{filters:[n],success:function(t,n){i.getView().getModel("objectView").setProperty+
("/showItems",t.results);e()}.bind(i),error:function(e){t()}})});g.then(function(e){if(!i._pDialog){i._pDialog=a.load({id:s.getId(),name:"ir.ZE144_IncompletionReport.Fragment.tableSelect",controller:i}).then(function(e){s.addDependent(e);return e})}i._pD+
ialog.then(function(e){i.getView().setBusy(false);e.open()}.bind(i))})},onCheckBoxSelect:function(e){var t=this.getView().getModel();var i=e.getParameter("selected");var n=new o("VBELN",r.EQ,this.oVBELN);var a;if(i){a=new o([n,new o("VAR",r.BT,this.oBtnS+
rc.getCustomData()[0].getKey(),"R")],true)}else{a=new o([n,new o("VAR",r.EQ,this.oBtnSrc.getCustomData()[0].getKey())],true)}t.read("/ItemsSet",{filters:[a],success:function(e,t){this.getView().getModel("objectView").setProperty("/showItems",e.results)}.+
bind(this),error:function(e){}})},onClosetblItems:function(){this.getView().byId("chktableSelect").setSelected(false);this._pDialog.then(function(e){e.close()})},onRefreshTable:function(){this.getView().getModel().read("/HeaderSet",{filters:this._addCrea+
teFilters(),success:function(e,t){this.getView().getModel("tableModel").setData(e.results)}.bind(this),error:function(e){}})},handleIncomLog:function(e){this._incompletionLogCall();var t=this.getView();if(!this._pValueHelpDialog){this._pValueHelpDialog=a+
.load({id:t.getId(),name:"ir.ZE144_IncompletionReport.Fragment.incompletionlog",controller:this}).then(function(e){t.addDependent(e);return e})}this._pValueHelpDialog.then(function(e){e.open()})},_handleValueHelpSearch:function(e){var t=e.getParameter("v+
alue");var i=new o("DESC",r.Contains,t);e.getSource().getBinding("items").filter([i])},_handleValueHelpClose:function(e){var t=e.getParameter("selectedItems"),i=this.getView().byId("idMIIncompLog");if(t&&t.length>0){t.forEach(function(e){i.addToken(new s+
({text:e.getTitle(),key:e.getCustomData()[0].getKey()}))})}},onSoldtoPartyPress:function(e,t){this.openQuickView(e,t)},openQuickView:function(e,t){var i=this.getView().getModel("quickView");var n=e.getSource(),o=this.getView();var r=n.getBindingContext("+
tableModel").getObject();var s;if(t==="so"){s={pages:[{pageId:"genericPageId",header:"Sold to Party",title:"Sold to Party",groups:[{elements:[{label:"Address",value:r.AGSTREET},{label:"City",value:r.AGCITY},{label:"Country",value:r.AGCOUNTRY},{label:"Mai+
l",value:r.AGEMAIL},{label:"Postal",value:r.AGPOSTAL},{label:"State",value:r.AGSTATE}]}]}]}}else{s={pages:[{pageId:"genericPageId",header:"Ship to Party",title:"Ship to Party",groups:[{elements:[{label:"Name",value:r.WENAME},{label:"Address",value:r.WEST+
REET},{label:"City",value:r.WECITY},{label:"Country",value:r.WECOUNTRY},{label:"Mail",value:r.WEEMAIL},{label:"Postal",value:r.WEPOSTAL},{label:"State",value:r.WESTATE}]}]}]}}i.setData(s);if(!this._pQuickView){this._pQuickView=a.load({id:o.getId(),name:"+
ir.ZE144_IncompletionReport.Fragment.customerQuickView",controller:this}).then(function(e){o.addDependent(e);return e})}this._pQuickView.then(function(e){e.openBy(n)})},_incompletionLogCall:function(){var e=new t;this.getView().setModel(e,"IncompLogSet")+
;var i=this._addCreateFilters();var n=this.getOwnerComponent().getModel();n.read("/IncompLogSet",{filters:i,success:function(t,i){e.setData(t.results)},error:function(e){}})},_onObjectMatched:function(e){this.Model=e.getParameter("arguments").Model;this.+
Waerk=e.getParameter("arguments").Waerk;var t=this._addCreateFilters();this.getModel().metadataLoaded().then(function(){this._bindView("/HeaderSet",t)}.bind(this))},_addCreateFilters:function(){var e=this._createFilters();var t=new o("MODEL",r.EQ,this.Mo+
del);var i=new o("WAERK",r.EQ,this.Waerk);e.push(t);e.push(i);return e},_createFilters:function(){var e=[];var t=this.getView().getModel("globalFilters").getData();for(var i in t){if(i!=="MODEL"){if(t[i].length>1){e.push(new o(t[i].map(function(e){return+
 new o(i,r.EQ,e)})))}else if(t[i].length===1){e.push(new o(i,r.EQ,t[i]))}}}return e},_bindView:function(e,i){var n=this.getModel("objectView"),o=this.getModel();var r=new t;this.getView().setModel(r,"tableModel");o.read("/HeaderSet",{filters:i,success:fu+
nction(e,t){this.getView().getModel("tableModel").setData(e.results);n.setProperty("/busy",false)}.bind(this),error:function(e){n.setProperty("/busy",false)}})},_onBindingChange:function(){var e=this.getView(),t=this.getModel("objectView"),i=e.getElement+
Binding();if(!i.getBoundContext()){this.getRouter().getTargets().display("objectNotFound");return}var n=this.getResourceBundle(),o=e.getBindingContext().getObject(),r=o.Vbeln,a=o.Agegrp;t.setProperty("/busy",false);t.setProperty("/shareSendEmailSubject",+
n.getText("shareSendEmailObjectSubject",[r]));t.setProperty("/shareSendEmailMessage",n.getText("shareSendEmailObjectMessage",[a,r,location.href]))}})});                                                                                                       