sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","../model/formatter","sap/ui/core/Fragment","sap/ui/Device","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/export/Spreadsheet","sap/ui/export/library","sap+
/ui/util/Storage"],function(e,t,i,n,o,s,a,r,g,l,d){"use strict";var u=l.EdmType;var c=new d(d.Type.session,"Document");var h=[];return e.extend("cob.v2.ZQTC_CREDIT_BLOCKED_ORDERS_SRV.controller.Object",{formatter:n,onInit:function(){var e=new sap.ui.mode+
l.json.JSONModel([]);this.getView().setModel(e,"mModel");var t=c.get("1");if(t){h=h.concat(t);this.getView().getModel("mModel").setData(t)}this._mViewSettingsDialogs={};this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this)}+
,onBeforeRendering:function(){},onNavBack:function(){var e=i.getInstance().getPreviousHash();if(e!==undefined){history.go(-1)}else{this.getRouter().navTo("worklist",{},true)}},_onObjectMatched:function(e){var t,i,n,o;t=e.getParameter("arguments").Vkorg;i+
=e.getParameter("arguments").Waerk;n=e.getParameter("arguments").Agegrp;o=e.getParameter("arguments").Auart;this.getModel().metadataLoaded().then(function(){var e=this.getView().getModel().createKey("CreditBlockedSOSet",{Auart:o,Vkorg:t,Waerk:i,Agegrp:n}+
);this._bindView("/"+e)}.bind(this))},_bindView:function(e){this.getView().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){},dataReceived:function(){}}})},_onBindingChange:function(){},onBack:function(){var e=+
i.getInstance().getPreviousHash();if(e!==undefined){history.go(-1)}else{this.getRouter().navTo("worklist",{},true)}},onRelease:function(e){var t=this.getView().byId("tbldata");var i=t.getSelectedItems();var n="";i.forEach(function(e){n+=e.getBindingConte+
xt().getProperty("Vbeln")+","});this.getView().setBusy(true);this.getView().getModel().callFunction("/ReleaseCreditBlock",{method:"GET",urlParameters:{Vbeln:n},success:function(e){h=h.concat(e.results);c.put("1",h);if(e.results.length){this.getView().get+
Model("mModel").setData(this.getView().getModel("mModel").getData().concat(e.results))}this.getView().getModel().refresh(true);this.byId("btnMsgPopover").setVisible(true);this.byId("btnMsgPopover").firePress();this.getView().setBusy(false)}.bind(this),er+
ror:function(e){this.getView().setBusy(false)}.bind(this)})},onMessagePopoverPress:function(e){this.getViewSettingsDialog("cob.v2.ZQTC_CREDIT_BLOCKED_ORDERS_SRV.Fragment.messagePopover").then(function(e){e.open()})},onMessageDlgClose:function(e){e.getSou+
rce().getParent().close()},downlaodRelDocs:function(e){var t=[],i,n,o,s;t.push({label:"Released Documents",type:u.String,property:"Vbeln"});s=this.getView().byId("dlgListMessageModel");i=s.getBinding("items");n={workbook:{columns:t,hierarchyLevel:"Level"+
},dataSource:i,fileName:"Table export sample.xlsx",worker:false};o=new g(n);o.build().finally(function(){o.destroy()})},getViewSettingsDialog:function(e){var t=this;var i=this._mViewSettingsDialogs[e];if(!i){i=o.load({id:this.getView().getId(),name:e,con+
troller:this}).then(function(e){if(s.system.desktop){e.addStyleClass("sapUiSizeCompact");t.getView().addDependent(e)}return e});this._mViewSettingsDialogs[e]=i}return i},handleSortButtonPressed:function(){this.getViewSettingsDialog("cob.v2.ZQTC_CREDIT_BL+
OCKED_ORDERS_SRV.Fragment.sortDialog").then(function(e){e.open()})},handleSortDialogConfirm:function(e){var t=this.getView().byId("tbldata"),i=e.getParameters(),n=t.getBinding("items"),o,s,a=[];o=i.sortItem.getKey();s=i.sortDescending;a.push(new r(o,s));+
n.sort(a)},handleFilterButtonPressed:function(){this.getViewSettingsDialog("cob.v2.ZQTC_CREDIT_BLOCKED_ORDERS_SRV.Fragment.filterDialog").then(function(e){e.open()})},handleFilterDialogConfirm:function(e){var t=this.byId("tbldata"),i=e.getParameters(),n=+
t.getBinding("items"),o=[];i.filterItems.forEach(function(e){var t=e.getKey().split("___"),i=t[0],n=t[1],s=t[2],r=t[3],g=new a(i,n,s,r);o.push(g)});n.filter(o)}})});                                                                                          